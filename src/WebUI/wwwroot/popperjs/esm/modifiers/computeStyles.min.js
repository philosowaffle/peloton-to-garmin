import{top,left,right,bottom,end}from"../enums.js";import getOffsetParent from"../dom-utils/getOffsetParent.js";import getWindow from"../dom-utils/getWindow.js";import getDocumentElement from"../dom-utils/getDocumentElement.js";import getComputedStyle from"../dom-utils/getComputedStyle.js";import getBasePlacement from"../utils/getBasePlacement.js";import getVariation from"../utils/getVariation.js";import{round}from"../utils/math.js";var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(t){var e=t.x,o=t.y,t=window.devicePixelRatio||1;return{x:round(e*t)/t||0,y:round(o*t)/t||0}}function mapToStyles(t){var e=t.popper,o=t.popperRect,s=t.placement,i=t.variation,a=t.offsets,p=t.position,r=t.gpuAcceleration,n=t.adaptive,l=t.roundOffsets,m=t.isFixed,f=a.x,d=void 0===f?0:f,u=a.y,c=void 0===u?0:u,g="function"==typeof l?l({x:d,y:c}):{x:d,y:c},d=g.x,c=g.y,y=a.hasOwnProperty("x"),x=a.hasOwnProperty("y"),v=left,t=top,f=window;n&&(u="clientHeight",g="clientWidth",(a=getOffsetParent(e))===getWindow(e)&&(a=getDocumentElement(e),"static"!==getComputedStyle(a).position&&"absolute"===p&&(u="scrollHeight",g="scrollWidth")),s!==top&&(s!==left&&s!==right||i!==end)||(t=bottom,c-=(m&&a===f&&f.visualViewport?f.visualViewport.height:a[u])-o.height,c*=r?1:-1),s!==left&&(s!==top&&s!==bottom||i!==end)||(v=right,d-=(m&&a===f&&f.visualViewport?f.visualViewport.width:a[g])-o.width,d*=r?1:-1));var n=Object.assign({position:p},n&&unsetSides),l=!0===l?roundOffsetsByDPR({x:d,y:c}):{x:d,y:c};return d=l.x,c=l.y,r?Object.assign({},n,((r={})[t]=x?"0":"",r[v]=y?"0":"",r.transform=(f.devicePixelRatio||1)<=1?"translate("+d+"px, "+c+"px)":"translate3d("+d+"px, "+c+"px, 0)",r)):Object.assign({},n,((n={})[t]=x?c+"px":"",n[v]=y?d+"px":"",n.transform="",n))}function computeStyles(t){var e=t.state,o=t.options,s=o.gpuAcceleration,t=void 0===s||s,s=o.adaptive,s=void 0===s||s,o=o.roundOffsets,o=void 0===o||o,t={placement:getBasePlacement(e.placement),variation:getVariation(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:t,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,mapToStyles(Object.assign({},t,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:o})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,mapToStyles(Object.assign({},t,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}export default{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};export{mapToStyles};