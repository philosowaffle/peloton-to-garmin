import{top,left,right,bottom,end}from"../enums.js";import getOffsetParent from"../dom-utils/getOffsetParent.js";import getWindow from"../dom-utils/getWindow.js";import getDocumentElement from"../dom-utils/getDocumentElement.js";import getComputedStyle from"../dom-utils/getComputedStyle.js";import getBasePlacement from"../utils/getBasePlacement.js";import getVariation from"../utils/getVariation.js";import{round}from"../utils/math.js";var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(t){var e=t.x,t=t.y,o=window.devicePixelRatio||1;return{x:round(e*o)/o||0,y:round(t*o)/o||0}}function mapToStyles(t){var e,o,s=t.popper,i=t.popperRect,a=t.placement,p=t.variation,r=t.offsets,n=t.position,l=t.gpuAcceleration,m=t.adaptive,f=t.roundOffsets,t=t.isFixed,d=r.x,d=void 0===d?0:d,u=r.y,u=void 0===u?0:u,c="function"==typeof f?f({x:d,y:u}):{x:d,y:u},c=(d=c.x,u=c.y,r.hasOwnProperty("x")),r=r.hasOwnProperty("y"),g=left,y=top,x=window,s=(m&&(v="clientHeight",o="clientWidth",(e=getOffsetParent(s))===getWindow(s)&&(e=getDocumentElement(s),"static"!==getComputedStyle(e).position&&"absolute"===n&&(v="scrollHeight",o="scrollWidth")),a!==top&&(a!==left&&a!==right||p!==end)||(y=bottom,u=(u-((t&&e===x&&x.visualViewport?x.visualViewport.height:e[v])-i.height))*(l?1:-1)),a!==left&&(a!==top&&a!==bottom||p!==end)||(g=right,d=(d-((t&&e===x&&x.visualViewport?x.visualViewport.width:e[o])-i.width))*(l?1:-1))),Object.assign({position:n},m&&unsetSides)),v=!0===f?roundOffsetsByDPR({x:d,y:u}):{x:d,y:u};return d=v.x,u=v.y,l?Object.assign({},s,((a={})[y]=r?"0":"",a[g]=c?"0":"",a.transform=(x.devicePixelRatio||1)<=1?"translate("+d+"px, "+u+"px)":"translate3d("+d+"px, "+u+"px, 0)",a)):Object.assign({},s,((p={})[y]=r?u+"px":"",p[g]=c?d+"px":"",p.transform="",p))}function computeStyles(t){var e=t.state,t=t.options,o=t.gpuAcceleration,o=void 0===o||o,s=t.adaptive,s=void 0===s||s,t=t.roundOffsets,t=void 0===t||t,o={placement:getBasePlacement(e.placement),variation:getVariation(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,mapToStyles(Object.assign({},o,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:t})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,mapToStyles(Object.assign({},o,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:t})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}export default{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};export{mapToStyles};